{% extends "base.html" %}
{% block title %}Publications Â· {{ super() }}{% endblock %}

{% block swiftypeMeta %}
<meta property="st:title" content="Publications" >
{% endblock %}

{% block content %}

<style>
#filterpub {
    font-size: 16px;
    height: 30px;
    padding: 4px 9px 4px 9px;
    border: 1px solid rgb(204, 204, 204);
    box-shadow: none !important;
}
</style>

<script type="text/javascript">
    function disp(s) {
        var win;
        var doc;
        win = window.open("", "WINDOWID");
        doc = win.document;
        doc.open("text/plain");
        doc.write("<pre>" + s + "</pre>");
        doc.close();
    }
</script>
<!-- <section id="content" class="body"> -->
    <h1 class="entry-title">Publications <a href=http://scholar.google.com/citations?user=pEj09c4AAAAJ><small>google citations</small></a></h1>
    <br>
    <ol class="list-of-pubs">
    {% for key, year, text, bibtex, pdf, slides, poster, url in publications %}
    <li id="{{ key }}" class><p>{{ text }}
    [&nbsp;<a href="javascript:disp('{{ bibtex|replace('\n', '\\n')|escape|forceescape }}');">Bibtex</a>&nbsp;]
    {% for label, target in [('PDF', pdf), ('Link', url), ('Slides', slides), ('Poster', poster)] %}
    {{ "[&nbsp;<a href=\"%s\">%s</a>&nbsp;]" % (target, label) if target }}
    {% endfor %}
    {% if citations %}
    &nbsp;[cited by {{citations}}]
    {% endif %}
    </p></li>
    {% endfor %}
    </ol>
<!-- </section> -->
{% endblock %}s

{% block sidebar %}
{{ super() }}
    <div class="well widget-filter">
        <h3>Filter Publications</h3>
        <br>
        <form class="form-search">
            <input type="text" class="input-medium search-query filterpub" placeholder="Find a tag" id="filterpub">
        </form>
        <span id="nopub" style="color:#8B0000;font-style:italic;font-size:14px"></span>
    </div>
{% endblock sidebar %}

{% block script %}
{{ super() }}

<script>
    (function ($) {
        // custom css expression for a case-insensitive contains()
        jQuery.expr[':'].Contains = function(a,i,m){
            return (a.textContent || a.innerText || "").toUpperCase().indexOf(m[3].toUpperCase())>=0;
        };

        function pubFilter() {

            $('.filterpub').change( function () {
                var filter = $(this).val();
                if(filter) {
                        // this finds all links in a list that contain the input,
                        // and hide the ones not containing the input while showing the ones that do
                        $('.list-of-pubs').find("p:not(:Contains(" + filter + "))").parent().hide();
                        $('.list-of-pubs').find("p:Contains(" + filter + ")").parent().show();

                        var numTags = $('.list-of-pubs').find("p:Contains(" + filter + ")").length;
                        if(numTags==0) {
                            $('#nopub').text('No matches found');
                        } else {
                            $('#nopub').text('');
                        }
                } else {
                    $('.list-of-pubs').find("li").fadeIn();
                    $('#nopub').text('');
                }
                return false;
            })
            .keyup( function () {
                // fire the above change event after every letter
                $(this).change();
            });
        }    

        //ondomready
        $(function () {
            pubFilter($());
        });

    }(jQuery));

</script>

{% endblock script %}