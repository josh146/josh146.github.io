{% extends 'base.html' %}

{% block title %}
Tags Â· {{ super() }}
{% endblock title %}

{% block head_description %}
All tags used in the {{ SITENAME|striptags }} blog.
{% endblock head_description %}

{% block feed_links %}
{{ super() }}
{% include '_includes/feeds_tags.html' %}
{% endblock feed_links %}

{% block content %}

<style>
#filterinput {
    font-size: 16px;
    height: 30px;
    padding: 4px 9px 4px 9px;
    border: 1px solid rgb(204, 204, 204);
    box-shadow: none !important;
}
</style>

<div class="row-fluid">
    <header class="span10 offset2">
    <h1><a href="{{ SITEURL }}/tags.html">All Tags</a></h1>
    </header>
</div>
<div class="row-fluid">
    <div class="span8 offset2">
        <ul class="list-of-tags sansserif">
            {% for tag, articles in tags|sort %}
            <li>
            {% set num = articles|count %}
            <a href="#{{ tag.slug }}-tag" class="scrollTo" data-name="{{tag}}">{{ tag }}<span>{{ num }}</span></a>
            </li>
            {% endfor %}

            <li style="display:none;" id="clearfilter">
                <a id="clearfilterlink" style="font-weight:500;color:gray">Clear filter<span></span></a>
            </li>
            <h4 id="notag" style="margin-top:7px"></h4>
        </ul>
    </div>
</div>
<br>
<div class="row-fluid">
    <div class="span8 offset2" id="in-tags-contains">
        {% for tag, articles in tags|sort %}
        <div class="articletag-container">
        <h2 id="{{ tag.slug }}-tag" class="tag-title">{{ tag }}</h2>
        <ul class="articles-in-tag list-articles-category">
            {% for article in articles|sort(reverse = true, attribute = 'date') %}
            {% set dateform = article.date.strftime('%b %d, %Y') %}
            <li><time pubdate="pubdate" datetime="{{ article.date.isoformat() }}">{{ dateform }}</time><a href="{{ SITEURL }}/{{ article.url }}" class="sansserif ">{{ article.title }} {%if article.subtitle %} <small style="color:#999999"> {{ article.subtitle }} </small> {% endif %} </a></li>
            {% endfor %}
        </ul>
        <hr style="margin-bottom:0px">
        <!-- <br> -->
        </div>
        {% endfor %}
    </div>
</div>

{% endblock content %}

{% block sidebar %}
{{ super() }}
    <div class="well widget-filter">
        <h3>Filter tags</h3>
        <br>
        <form class="form-search">
            <input type="text" class="input-medium search-query filterinput" placeholder="Find a tag" id="filterinput">
        </form>
    </div>
{% endblock sidebar %}

{% block script %}
{{ super() }}

<script>
    (function ($) {
        // custom css expression for a case-insensitive contains()
        jQuery.expr[':'].Contains = function(a,i,m){
            return (a.textContent || a.innerText || "").toUpperCase().indexOf(m[3].toUpperCase())>=0;
        };

        function listFilter() {

            $('.filterinput').change( function () {
                var filter = $(this).val();
                if(filter) {
                    filterTagChange(filter,'slide');
                } else {
                    $('.list-of-tags').find("li").show().not('clearfilter');
                    $('.articletag-container').show();
                    $('#notag').text('');
                    $('#clearfilter').hide();
                }
                return false;
            })
            .keyup( function () {
                // fire the above change event after every letter
                $(this).change();
            });
        }    

        var tagref = $(location).attr('hash').split("-").shift().split("#").pop();

        //ondomready
        $(function () {
            $('#filterinput').val(tagref);
            if(tagref){
                filterTagChange(tagref,'hide');
            }
            listFilter($());
        });

    }(jQuery));

</script>

{% endblock script %}
