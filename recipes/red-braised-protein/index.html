<!DOCTYPE html>
<html lang="en">

<head>

  <title>Red braised [protein] recipe | josh iza.ac</title>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Josh Izaac">
  <meta name="description" content="Red braising is a braising technique used in Chinese cooking that produces a delicious caramel and savoury reddish-brown sauce. Traditionally made by caramelizing rock sugar in oil, a lot of recipes these days instead opt for dark soy sauce to lend those caramelized notes and...
">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png">
  <link rel="manifest" href="/images/favicon/site.webmanifest">
  <link rel="mask-icon" href="/images/favicon/safari-pinned-tab.svg" color="#5bbad5">
  <link rel="shortcut icon" href="/images/favicon/favicon.ico">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-config" content="/images/favicon/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">

  <!-- Facebook Meta Tags -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Red braised [protein] recipe | josh iza.ac">
  <meta property="og:url" content=" recipes/red-braised-protein/ ">
  <meta property="og:description" content="Red braising is a braising technique used in Chinese cooking that produces a delicious caramel and savoury reddish-brown sauce. Traditionally made by caramelizing rock sugar in oil, a lot of recipes these days instead opt for dark soy sauce to lend those caramelized notes and...
">
  <meta property="og:image" content="/images/recipes/red-braised-chicken.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta property="twitter:domain" content="../..">
  <meta property="twitter:url" content=" recipes/red-braised-protein/ ">
  <meta name="twitter:title" content="Red braised [protein] recipe | josh iza.ac">
  <meta name="twitter:description" content="Red braising is a braising technique used in Chinese cooking that produces a delicious caramel and savoury reddish-brown sauce. Traditionally made by caramelizing rock sugar in oil, a lot of recipes these days instead opt for dark soy sauce to lend those caramelized notes and...
">
  <meta name="twitter:image" content="/images/recipes/red-braised-chicken.jpg">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
  <link rel="stylesheet" href="../../theme/css/font.css" type="text/css" media="all">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
  <link rel="stylesheet" href="../../theme/css/style.css" type="text/css" media="all">
  <link rel="stylesheet" href="../../theme/css/recipe_gallery.css" type="text/css" media="all">
  <link rel="stylesheet" href="../../theme/css/pygments.css" type="text/css" media="all">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">

  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.6.347/pdf.min.js"></script>

  <script type="module" src="https://unpkg.com/ninja-keys?module"></script>


<script src="https://code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="../../theme/js/functions.js"></script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Amatic+SC:wght@700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=DM+Mono&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Syne+Mono&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Fira+Mono&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Fira+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">

  <link href="http://iza.ac/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="josh iza.ac Full Atom Feed" />

      <meta name="keywords" content="keywords, pytorch, quantum, gradients, tensorflow">

    <link rel="stylesheet" href="../../theme/css/recipe.css">
    <script type="application/ld+json">
        {
          "@context": "https://schema.org/",
          "@type": "Recipe",
          "name": "Red braised [protein]",
          "image": [
            "../..//images/recipes/red-braised-chicken.jpg"
          ],
          "author": {
            "@type": "Person",
            "name": "Josh Izaac"
          },
          "datePublished": "2025-12-31 00:00:00+08:00",
          "description": "Red braising is a braising technique used in Chinese cooking that produces a delicious caramel and savoury reddish-brown sauce. Traditionally made by...",

          "totalTime": "PT3.5H (slow cooked), or 1.5H (pressure cooked)",

          "recipeYield": "5-6 servings",

          "recipeIngredient": [
            "1 tbsp cornflour",
            "1 inch ginger (julienned)",
            "3 cloves garlic (sliced)",
            "1 spring onion (white part cut into 2 inch sections)",
            "1/3 cup (80ml) Shaoxing wine",
            "1/4 cup (60ml) soy sauce",
            "1 tbsp dark soy sauce",
            "40g brown sugar",
            "200-400ml stock or water",
            "Salt and MSG to taste",
            "Spring onion (green part thinly sliced)",
            "Coriander",
            "Sesame oil"
          ],

          "recipeInstructions": [
            {
              "@type": "HowToStep",
              "text": "In a pot over medium heat, add a neutral oil and stir fry the {{aromatics}} until fragrant. Then,
add the {{spices}} and stir fry for 30 seconds."
            },
            {
              "@type": "HowToStep",
              "text": "Stir through the Shaoxing wine, and then add the rest of the {{braising_liquid}} ingredients, adding enough stock or water to just cover the {{protein}}. Add
the {{vegetables}}, and then cook until your {{protein}} is {{tender}}1."
            },
            {
              "@type": "HowToStep",
              "text": "Increase the heat to high, and rapidly reduce to the sauce (to approximately half to a third of the original volume)."
            },
            {
              "@type": "HowToStep",
              "text": "If serving over noodles (such as lamian), no need to thicken the sauce. Simply prepare your
noodles as per directions (making sure to rinse the noodles under cold water), and then spoon over
a few ladles of broth, and top with the {{protein}}, {{vegetables}}, and {{garnishes}}."
            },
            {
              "@type": "HowToStep",
              "text": "If serving over rice, mix the cornflour with water to form a slurry, and add half of the
cornflour slurry. Reduce the sauce over medium heat until you are happy with the sauce
consistency — add more cornflour slurry as needed. Serve alongside (or on top of) rice, adding the {{garnishes}} on top."
            }
          ]
        }
    </script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-308113-3', 'auto');
  ga('send', 'pageview');

</script>

</head>

<body class="home blog">
  <div>
    <header class="site-header">
      <nav class="navbar navbar-expand-lg navbar-default" role="navigation">
        <div class="container">
          <div class="row" style="width: 100%;">
            <div class="site-navigation-inner col-sm-12">
              <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <i class="social fas fa-ellipsis-v"></i>
              </button>

              <div class="collapse navbar-collapse navbar-ex1-collapse" id="navbarSupportedContent" style="float: left;">
                <ul id="menu-all-pages" class="nav navbar-nav mr-auto" style="padding: 20px;">
                  <li class="menu-item"><a href="/" >Home

<i class=" fa-lg" style=""></i></a></li>
                  <li class="menu-item"><a href="/about" >About

<i class=" fa-lg" style=""></i></a></li>
                  <li class="menu-item"><a href="/cv" >CV

<i class=" fa-lg" style=""></i></a></li>
                  <li class="menu-item"><a href="/recipes" >recipes

<i class=" fa-lg" style=""></i></a></li>
                  <li class="menu-item"><a href="/posts" >posts

<i class=" fa-lg" style=""></i></a></li>
                </ul>
              </div>
              <div class="social">
                <a href="https://scholar.google.com/citations?user=pEj09c4AAAAJ" title="Google Scholar" >

<i class="ai ai-google-scholar fa-lg" style="font-size: 1.6rem;"></i></a>
                <a href="http://github.com/josh146" title="GitHub" >

<i class="fab fa-github fa-lg" style=""></i></a>
                <a href="https://linkedin.com/pub/josh-izaac/104/9bb/6a2" title="LinkedIn" >

<i class="fab fa-linkedin fa-lg" style=""></i></a>
                <a data-email="ca.azi@hsoj:otliam" data-title="Email" title="You need javascript enabled to view this email" class="email">

<i class="fas fa-envelope fa-lg" style=""></i></a>
                <a href="/feeds/rss.xml" title="Feed" >

<i class="fas fa-rss fa-lg" style=""></i></a>
               <a href="#" onClick="const ninja=document.querySelector('ninja-keys');ninja.open();"><i class="fas fa-search"></i></a>
              </div>
            </div>
          </div>
        </div>
      </nav><!-- .site-navigation -->


  </header><!-- #masthead -->
  </div>
    <div id="content" class="site-content">
      <div class="container main-content-area">
        <div class="row">
          <div class="main-content-inner col-sm-12 col-md-12">
            <div id="primary" class="content-area">
              <div id="main" class="site-main" role="main">
                <div class="article-container">


<article class="recipe-container">

    <header class="recipe-header">

        <div class="hero-image" style="background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('/images/recipes/red-braised-chicken.jpg');">
            <h1 class="recipe-title hero-text">Red braised [protein]</h1>
        </div>

        <div class="recipe-meta-badges">
                <span>TIME</span><span>3.5 hours (slow cooked), or 1.5 hours (pressure cooked)</span>
                <span>MAKES</span><span id="servings-badge" data-original="5-6"><span class="scalable" data-base="5.0">5</span>-<span class="scalable" data-base="6.0">6</span></span>
                <span class="scale-label">PORTION</span>
                <div class="scale-controls">
                    <a class="scale-btn" onclick="scaleRecipe(0.5, this)">0.5x</a>
                    <a class="scale-btn active" onclick="scaleRecipe(1, this)">1x</a>
                    <a class="scale-btn" onclick="scaleRecipe(2, this)">2x</a>
                    <a class="scale-btn" onclick="scaleRecipe(3, this)">3x</a>
                </div>
        </div>
<!--         <div class="github-link">
            <a href="https://github.com/josh146/josh146.github.io/blob/source/content/recipes/red-braised-protein.md"
               target="_blank">
               VIEW SOURCE
            </a>
        </div> -->

        <div class="recipe-intro">
            <p>Red braising is a braising technique used in Chinese cooking that produces a delicious caramel and savoury reddish-brown sauce. Traditionally made by caramelizing rock sugar in oil, a lot of recipes these days instead opt for dark soy sauce to lend those caramelized notes and hues.</p>
<p>Below is a blueprint recipe for red braised anything, as well as variations for red braised beef (hóngshāo niúròu) and red braised chicken, based on various recipes online including <a href="https://chinesecookingdemystified.substack.com/p/red-braised-anything">Chinese cooking demystified</a>. </p>
<div id="variation-controls"></div>

        </div>
    </header>


    <div class="recipe-grid">
        <section class="recipe-ingredients">
            <h2>INGREDIENTS</h2>
            
<p>Feel free to use any protein <span class="paren">(suitable for braising)</span> and vegetables you wish, including mushrooms, potatoes, yam, etc.</p>
<p>{{protein_list}}{{vegetable_list}}</p>
<ul>
<li><span class="scalable" data-base="1.0">1</span> tbsp cornflour</li>
</ul>
<h3>Aromatics</h3>
<ul>
<li><span class="scalable" data-base="1.0">1</span> inch ginger <span class="paren">(julienned)</span></li>
<li><span class="scalable" data-base="3.0">3</span> cloves garlic <span class="paren">(sliced)</span></li>
<li><span class="scalable" data-base="1.0">1</span> spring onion <span class="paren">(white part cut into <span class="scalable" data-base="2.0">2</span> inch sections)</span></li>
</ul>
<h3>Spices</h3>
<p>Whole spices to add can include star anise, five spice powder, dried chillies, cinnamon, cloves, sichuan peppercorns,
fennel seeds, etc. Don’t add too many or too much, or you may make the braise taste medicinal!</p>
<p>{{spice_list}}</p>
<h3>Braising liquid</h3>
<ul>
<li><span class="scalable" data-base="0.3333333333333333">1/3</span> cup <span class="paren">(<span class="scalable" data-base="80.0">80</span>ml)</span> Shaoxing wine</li>
<li><span class="scalable" data-base="0.25">1/4</span> cup <span class="paren">(<span class="scalable" data-base="60.0">60</span>ml)</span> soy sauce</li>
<li><span class="scalable" data-base="1.0">1</span> tbsp dark soy sauce</li>
<li><span class="scalable" data-base="40.0">40</span>g brown sugar</li>
<li><span class="scalable" data-base="200.0">200</span>-<span class="scalable" data-base="400.0">400</span>ml stock or water</li>
</ul>
<h3>Garnishes</h3>
<ul>
<li>Salt and <span class="caps">MSG</span> to taste</li>
<li>Spring onion <span class="paren">(green part thinly sliced)</span></li>
<li>Coriander</li>
<li>Sesame oil</li>
</ul>
<pre id="variation-yaml" style="display:none;">Theme: Beef
protein_list: <span class="scalable" data-base="1.0">1</span>-<span class="scalable" data-base="1.5">1.5</span>kg beef <span class="paren">(cut into <span class="scalable" data-base="2.0">2</span> inch cubes. Choose cuts rich in collagen, such as chuck, brisket, short ribs, shank, and oxtail.)</span>
protein: beef
vegetable_list: <span class="scalable" data-base="100.0">100</span>g shiitake mushrooms <span class="paren">(sliced)</span>
beef_sear_step: Add the beef, and continue to stir fry for <span class="scalable" data-base="1.0">1</span>-<span class="scalable" data-base="2.0">2</span> minutes until browned.
spice_list: <span class="scalable" data-base="4.0">4</span> dried chillies; <span class="scalable" data-base="3.0">3</span> star anise; <span class="scalable" data-base="1.0">1</span> tsp five-spice powder
tender: tender <span class="paren">(simmer <span class="scalable" data-base="1.0">1</span>-<span class="scalable" data-base="3.0">3</span> hours depending on the cut of beef or pressure cook for <span class="scalable" data-base="45.0">45</span> minutes on high)</span>

---

Theme: Chicken
protein_list: <span class="scalable" data-base="3.0">3</span> chicken maryland, or <span class="scalable" data-base="5.0">5</span>-<span class="scalable" data-base="6.0">6</span> thighs/drumsticks
protein: chicken
vegetable_list: <span class="scalable" data-base="100.0">100</span>g shiitake mushrooms <span class="paren">(sliced)</span>
chicken_sear_step: Sear the chicken, skin down side, until browned. Remove from the pan temporarily.
spice_list: <span class="scalable" data-base="4.0">4</span> dried chillies
tender: tender <span class="paren">(simmer for about <span class="scalable" data-base="20.0">20</span>-<span class="scalable" data-base="30.0">30</span> minutes)</span>
</pre>

        </section>

        <section class="recipe-method">
            <h2>STEPS</h2>
            
<p>{{chicken_sear_step}}</p>
<ol>
<li>In a pot over medium heat, add a neutral oil and stir fry the {{aromatics}} until fragrant. Then,
add the {{spices}} and stir fry for 30 seconds. </li>
</ol>
<p>{{beef_sear_step}}</p>
<ol>
<li>
<p>Stir through the Shaoxing wine, and then add the rest of the {{braising_liquid}} ingredients, adding enough stock or water to <em>just</em> cover the {{protein}}. Add
the {{vegetables}}, and then cook until your {{protein}} is {{tender}}<sup id="sf-red-braised-protein-1-back"><a class="simple-footnote" href="#sf-red-braised-protein-1" title="You can simmer on the stovetop, or in the oven at 150ºC.">1</a></sup>.</p>
</li>
<li>
<p>Increase the heat to high, and rapidly reduce to the sauce (to approximately half to a third of the original volume).</p>
</li>
<li>
<p>If serving over noodles (such as lamian), no need to thicken the sauce. Simply prepare your
noodles as per directions (making sure to rinse the noodles under cold water), and then spoon over
a few ladles of broth, and top with the {{protein}}, {{vegetables}}, and {{garnishes}}.</p>
</li>
<li>
<p>If serving over rice, mix the cornflour with water to form a slurry, and add <em>half</em> of the
cornflour slurry. Reduce the sauce over medium heat until you are happy with the sauce
consistency — add more cornflour slurry as needed. Serve alongside (or on top of) rice, adding the {{garnishes}} on top.</p>
</li>
</ol><script charset="utf-8" src="//platform.twitter.com/widgets.js"></script>
        </section>
    </div>

    <div class="recipe-notes">
        <h2>NOTES</h2>
        
        <ol class="simple-footnotes"><li id="sf-red-braised-protein-1"><footnote>You can simmer on the stovetop, or in the oven at 150ºC.</footnote> <a class="simple-footnote-back" href="#sf-red-braised-protein-1-back">↩︎</a></li></ol>

    </div>

    <div class="related">
        <h2>Related</h2>
        <div id="recipe-gallery" class="recipe-gallery">
            <div class="recipe-card">
                <a href="/recipes/braised-lamb-shoulder-chops-with-rice/">
                    <div class="card-image-wrapper">
                        <img src="/images/recipes/braised-lamb-rice.jpg" alt="Braised lamb shoulder chops with rice">
                    </div>

                    <div class="card-details">
                        <h3>Braised lamb shoulder chops with rice</h3>
                    </div>
                </a>
            </div>
            <div class="recipe-card">
                <a href="/recipes/cantonese-style-bao/">
                    <div class="card-image-wrapper">
                        <img src="/images/recipes/cantonese-style-bao.jpg" alt="Cantonese-style bao">
                    </div>

                    <div class="card-details">
                        <h3>Cantonese-style bao</h3>
                    </div>
                </a>
            </div>
            <div class="recipe-card">
                <a href="/recipes/chicken-xiao-long-bao/">
                    <div class="card-image-wrapper">
                        <img src="/images/recipes/xiao-long-bao.jpg" alt="Chicken xiao long bao">
                    </div>

                    <div class="card-details">
                        <h3>Chicken xiao long bao</h3>
                    </div>
                </a>
            </div>
        </div>
    </div>

</article>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const ingredientContainer = document.querySelector('.recipe-ingredients');

    if (ingredientContainer) {
        ingredientContainer.addEventListener('click', function(e) {
            const li = e.target.closest('li');

            // If we didn't click inside an li, or we clicked the container padding, ignore.
            if (!li) return;

            // check if the user clicked an interactive element
            if (e.target.closest('a')) {
                return;
            }

            li.classList.toggle('done');
        });
    }
});
</script>

<script>
function scaleRecipe(multiplier, btnElement) {
    document.querySelectorAll('.scale-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    btnElement.classList.add('active');

    document.querySelectorAll('.scalable').forEach(el => {
        const baseVal = parseFloat(el.dataset.base);
        if (!isNaN(baseVal)) {
            const newVal = baseVal * multiplier;

            // Remove trailing zeros (e.g. 2.50 -> 2.5)
            // parseFloat(num.toFixed(2)) handles rounding to 2 decimal places
            // and stripping unnecessary zeros automatically.
            el.innerText = parseFloat(newVal.toFixed(2));
        }
    });


    // update Servings Badge
    const servBadge = document.getElementById('servings-badge');
    servBadge.querySelectorAll('.scalable').forEach(el => {
        const baseVal = parseFloat(el.dataset.base);
        if (!isNaN(baseVal)) {
            const newVal = baseVal * multiplier;

            // Remove trailing zeros (e.g. 2.50 -> 2.5)
            // parseFloat(num.toFixed(2)) handles rounding to 2 decimal places
            // and stripping unnecessary zeros automatically.
            el.innerText = parseFloat(newVal.toFixed(2));
        }

    });
}
</script>

<script>
document.querySelectorAll('.recipe-method li').forEach(li => {
    li.addEventListener('click', function() {
        const parent = this.parentNode;

        // if clicking the already highlighted item, turn off focus mode
        if (this.classList.contains('highlighted')) {
            this.classList.remove('highlighted');
            parent.classList.remove('focus-active');
        } else {
            // remove highlight from others
            parent.querySelectorAll('li').forEach(el => el.classList.remove('highlighted'));

            // highlight this one
            this.classList.add('highlighted');
            parent.classList.add('focus-active');
        }
    });
});
</script>


<script>
// Add hover preview for component links
document.querySelectorAll('.component-link').forEach(link => {
    const isDesktop = window.matchMedia("(pointer: fine)").matches;

    if (isDesktop) {
        link.addEventListener('mouseenter', async function() {
            // Create tooltip if it doesn't exist
            let tooltip = document.getElementById('recipe-preview-tooltip');
            if (!tooltip) {
                tooltip = document.createElement('div');
                tooltip.id = 'recipe-preview-tooltip';
                document.body.appendChild(tooltip);
            }

            // Position it
            const rect = this.getBoundingClientRect();
            tooltip.style.left = `${rect.left}px`;
            tooltip.style.top = `${rect.bottom + 5}px`;
            tooltip.style.display = 'block';
            tooltip.innerHTML = 'Loading...';

            // Fetch the linked page
            try {
                const response = await fetch(this.href);
                const text = await response.text();

                // Parse the response to grab just the ingredients list
                const parser = new DOMParser();
                const doc = parser.parseFromString(text, 'text/html');

                // Assuming your ingredients are in a container with class 'recipe-ingredients'
                const ingredients = doc.querySelector('.recipe-ingredients ul').innerHTML;
                const title = doc.querySelector('h1').innerText;
                const imageURL = extractBackgroundUrl(doc, '.hero-image');

                tooltip.innerHTML = `<strong>${title}</strong><img src=${imageURL} />`;
                // tooltip.innerHTML = `<strong>${title}</strong><img src=${imageURL} /><ul>${ingredients}</ul>`;
            } catch (e) {
                tooltip.style.display = 'none';
                console.log('Error loading preview.');
            }
        });

        link.addEventListener('mouseleave', () => {
            const tooltip = document.getElementById('recipe-preview-tooltip');
            if (tooltip) tooltip.style.display = 'none';
        });
    } else {
        console.log("Not a fine pointer device, 'mouseenter' event listener not attached.");
    }
});

function extractBackgroundUrl(doc, el) {
    const element = doc.querySelector(el);
    const backgroundImage = element.style.backgroundImage;
    const url = backgroundImage.slice(61, -1).replace(/['"]/g, "");
    return url;
}
</script>

<script>
// Blueprint recipes
document.addEventListener('DOMContentLoaded', () => {
    const yamlBlock = document.getElementById('variation-yaml');
    if (!yamlBlock) return;

    const rawText = yamlBlock.innerText;
    const variations = {};

    // Split by the separator "---" to get each theme block
    const blocks = rawText.split('---');

    blocks.forEach(block => {
        if (!block.trim()) return; // Skip empty blocks

        const currentThemeData = {};
        let themeName = null;

        // Split by lines
        const lines = block.trim().split('\n');

        lines.forEach(line => {
            // Find the first colon to separate Key and Value
            const separatorIndex = line.indexOf(':');
            if (separatorIndex === -1) return; // Skip invalid lines

            const key = line.substring(0, separatorIndex).trim();
            const value = line.substring(separatorIndex + 1).trim();

            if (key === 'Theme') {
                themeName = value;
            } else {
                currentThemeData[key] = value;
            }
        });

        if (themeName) {
            variations[themeName] = currentThemeData;
        }
    });

    // build the UI Controls
    const controlContainer = document.getElementById('variation-controls');
    controlContainer.innerHTML = '<span class="vibe-label">Choose your Vibe</span>';

    const btnGroup = document.createElement('div');
    btnGroup.className = 'vibe-buttons';

    // create a "Blueprint" (Reset) button
    const resetBtn = document.createElement('button');
    resetBtn.innerText = 'Blueprint';
    resetBtn.className = 'vibe-btn active';
    resetBtn.id = 'Blueprint';
    resetBtn.onclick = () => applyVariation('Blueprint', resetBtn);
    btnGroup.appendChild(resetBtn);

    // create buttons for each theme
    Object.keys(variations).forEach(theme => {
        const btn = document.createElement('button');
        btn.innerText = theme;
        btn.className = 'vibe-btn';
        btn.id = theme;
        btn.onclick = () => applyVariation(theme, btn);
        btnGroup.appendChild(btn);
    });

    controlContainer.appendChild(btnGroup);

    let blueprintsInitialized = false;

    function applyVariation(themeName, clickedBtn) {
        const url = new URL(window.location);
        url.searchParams.set('vibe', themeName);
        window.history.replaceState({}, '', url);

        // update Buttons Visual State
        document.querySelectorAll('.vibe-btn').forEach(b => b.classList.remove('active'));
        if (clickedBtn) clickedBtn.classList.add('active');

        // Find placeholders in the DOM
        if (!blueprintsInitialized) {
            const contentArea = document.querySelector('.recipe-container');
            if (contentArea) {
                const walker = document.createTreeWalker(contentArea, NodeFilter.SHOW_TEXT, null, false);
                let node;
                // split the string so Pelican/Jinja doesn't try to parse it
                const startBracket = '{' + '{';

                while(node = walker.nextNode()) {
                    if (node.nodeValue.includes(startBracket)) {
                        const parent = node.parentNode;
                        // Save original text if not already saved
                        if (!parent.hasAttribute('data-blueprint')) {
                            parent.setAttribute('data-blueprint', parent.innerHTML);
                            parent.classList.add('dynamic-slot');
                        }
                    }
                }
                blueprintsInitialized = true;
            }
        }

        // the update loop
        const slots = document.querySelectorAll('.dynamic-slot');

        slots.forEach(slot => {
            let htmlToUpdate = slot.getAttribute('data-blueprint');

            // Reset parent styling (Assume standard item first)
            if (slot.parentElement && slot.parentElement.tagName === 'LI') {
                slot.parentElement.classList.remove('is-sublist-parent');
            }

            // apply defined replacements
            if (themeName && variations[themeName]) {
                const replacements = variations[themeName];

                Object.keys(replacements).forEach(key => {
                    const regex = new RegExp('{' + '{' + key + '}' + '}', 'g');
                    let value = replacements[key];

                    // If this key exists in the current theme, replace it
                    if (value) {
                        if (key.includes('list')) {
                            // Multi-item List Logic
                            const items = value.split(';').map(item => `<li>${item.trim()}</li>`).join('');
                            value = `<ul class="dynamic-sublist">${items}</ul>`;
                        } else if (key.includes('step')) {
                            // step logic
                            value = `<ol class="dynamic-sublist"><li><strong>${value}</strong></li></ol>`;

                        } else {
                            // Standard Single Item
                            value = `<strong>${value}</strong>`;
                        }

                        htmlToUpdate = htmlToUpdate.replace(regex, value);
                    }
                });
            }

            // This handles "Blueprint Mode" AND any missing variables in specific themes
            const pillRegex = new RegExp('{' + '{([a-zA-Z0-9_]+?)}' + '}', 'g');

            htmlToUpdate = htmlToUpdate.replace(pillRegex, (match, key) => {
                const cleanName = key.replace(/_/g, ' ');

                if (key.includes('list') || key.includes('step')) {
                    return `<span class="variable-pill variable-list">${cleanName}</span>`;
                }
                return `<span class="variable-pill">${cleanName}</span>`;
            });

            // parens styling
            if (slot.closest('ul') || slot.closest('.recipe-ingredients')) {
                htmlToUpdate = htmlToUpdate.replace(/\(([^)<]+)\)(?![^<]*>)/g, '<span class="paren">($1)</span>');
                }

            // Render
            slot.innerHTML = htmlToUpdate;
            slot.classList.remove('changed');
            void slot.offsetWidth;
            slot.classList.add('changed');
        });
    }

    const urlParams = new URLSearchParams(window.location.search);
    const themeName = urlParams.get('vibe');

    if (Object.keys(variations).includes(themeName)) {
        applyVariation(themeName, document.getElementById(themeName));
    } else {
        applyVariation('Blueprint', document.querySelector('.vibe-btn.active'));
    }
});
</script>

                </div>
              </div><!-- #main -->
          </div><!-- #primary -->
        </div>
      </div><!-- close .row -->
    </div><!-- close .container -->
  </div><!-- close .site-content -->




  <div id="footer-area">
    <footer id="colophon" class="site-footer" role="contentinfo">
      <div class="site-info container">
        <div class="row">
                    <div class="copyright col-md-12">
                    This site uses the <a href="https://github.com/limbenjamin/voce">voce</a> theme by <a href="//limbenjamin.com/">Benjamin Lim</a><br />
                    &copy; 2025 <a href="../..">Josh Izaac</a> </div>
        </div>
      </div><!-- .site-info -->
      <div class="scroll-to-top" style="display: none;"><i class="fa fa-angle-up"></i></div><!-- .scroll-to-top -->
    </footer><!-- #colophon -->
  </div>


  <script type="text/javascript">
    window.addEventListener('load', function(){
      var e = document.querySelectorAll(".email");
      for (var i = 0; i < e.length; i++) {
        var email = e[i].getAttribute("data-email")
        var title = e[i].getAttribute("data-title")
        if (email){
          e[i].href = email.split("").reverse().join("");
          e[i].removeAttribute("data-email");
          e[i].removeAttribute("data-title");
          e[i].removeAttribute("class");
          if (title){
            e[i].setAttribute("title", title);
          }
          else{
            e[i].removeAttribute("title");
          }
        }
      }
    })
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
        const ninja = document.querySelector('ninja-keys');

        if (ninja) {
            // 1. Load your JSON index
            fetch('/search.json')
                .then(response => response.json())
                .then(data => {
                    // 2. Transform into Ninja Keys format
                    const menuItems = data.map(item => ({
                        id: item.url,
                        title: item.title,
                        section: item.type, // Groups results by 'Recipe' vs 'Page'
                        keywords: item.keywords,
                        handler: () => {
                            window.location.href = item.url;
                        }
                    }));

                    // 3. Add static actions (Optional)
                    // e.g., Dark Mode toggle, Home button
                    menuItems.push({
                        id: 'home',
                        title: 'Go to Home',
                        section: 'Navigation',
                        hotkey: 'cmd+h',
                        handler: () => { window.location.href = '/'; }
                    });

                    // 4. Give data to Ninja Keys
                    ninja.data = menuItems;
                })
                .catch(err => console.error("Failed to load search index:", err));
        }
    });
  </script>


  <ninja-keys placeholder="Search..." hideBreadcrumbs></ninja-keys>
</body>
</html>