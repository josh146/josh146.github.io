<!DOCTYPE html>
<html lang="en">

<head>

  <title>Rough puff pastry recipe | josh iza.ac</title>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Josh Izaac">
  <meta name="description" content="Rough puff (also known as blitz puff) is a method of approximating puff pastry where the butter is incorporated directly into the dough using large sheets of butter. The dough will start off looking very rough and shaggy, but by the time you have rolled it out and performed...
">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png">
  <link rel="manifest" href="/images/favicon/site.webmanifest">
  <link rel="mask-icon" href="/images/favicon/safari-pinned-tab.svg" color="#5bbad5">
  <link rel="shortcut icon" href="/images/favicon/favicon.ico">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-config" content="/images/favicon/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">

  <!-- Facebook Meta Tags -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Rough puff pastry recipe | josh iza.ac">
  <meta property="og:url" content=" recipes/rough-puff-pastry/ ">
  <meta property="og:description" content="Rough puff (also known as blitz puff) is a method of approximating puff pastry where the butter is incorporated directly into the dough using large sheets of butter. The dough will start off looking very rough and shaggy, but by the time you have rolled it out and performed...
">
  <meta property="og:image" content="/images/recipes/rough-puff.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta property="twitter:domain" content="../..">
  <meta property="twitter:url" content=" recipes/rough-puff-pastry/ ">
  <meta name="twitter:title" content="Rough puff pastry recipe | josh iza.ac">
  <meta name="twitter:description" content="Rough puff (also known as blitz puff) is a method of approximating puff pastry where the butter is incorporated directly into the dough using large sheets of butter. The dough will start off looking very rough and shaggy, but by the time you have rolled it out and performed...
">
  <meta name="twitter:image" content="/images/recipes/rough-puff.jpg">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
  <link rel="stylesheet" href="../../theme/css/font.css" type="text/css" media="all">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
  <link rel="stylesheet" href="../../theme/css/style.css" type="text/css" media="all">
  <link rel="stylesheet" href="../../theme/css/recipe_gallery.css" type="text/css" media="all">
  <link rel="stylesheet" href="../../theme/css/pygments.css" type="text/css" media="all">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">

  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.6.347/pdf.min.js"></script>

  <script type="module" src="https://unpkg.com/ninja-keys?module"></script>


<script src="https://code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="../../theme/js/functions.js"></script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Amatic+SC:wght@700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=DM+Mono&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Syne+Mono&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Fira+Mono&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Fira+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">

  <link href="http://iza.ac/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="josh iza.ac Full Atom Feed" />

      <meta name="keywords" content="keywords, pytorch, quantum, gradients, tensorflow">

    <link rel="stylesheet" href="../../theme/css/recipe.css">
    <script type="application/ld+json">
        {
          "@context": "https://schema.org/",
          "@type": "Recipe",
          "name": "Rough puff pastry",
          "image": [
            "../..//images/recipes/rough-puff.jpg"
          ],
          "author": {
            "@type": "Person",
            "name": "Josh Izaac"
          },
          "datePublished": "2025-12-27 00:00:00+08:00",
          "description": "Rough puff (also known as blitz puff) is a method of approximating puff pastry where the butter is incorporated directly into the dough using large sheets...",

          "totalTime": "PT1.5H",

          "recipeYield": "585g of pastry. Makes enough for two single-crusted pie, or one double-crusted pie. servings",

          "recipeIngredient": [
            "225g plain flour (plus more for dusting)",
            "225g unsalted butter (cold, cut into 1/2 inch cubes)",
            "115g cold tap water",
            "15g (1 tbsp) sugar",
            "1 tsp (4g) kosher salt"
          ],

          "recipeInstructions": [
            {
              "@type": "HowToStep",
              "text": "For the Dough: Whisk flour, sugar, and salt together in a medium bowl. Toss the cubed butter with
the flour mixture to break up the pieces. With your fingertips, smash each cube flat into a
sheet — no rubbing or cutting1."
            },
            {
              "@type": "HowToStep",
              "text": "Stir in water, then knead dough against the sides of the bowl until it comes together in a shaggy
ball. Dough temperature should register between 18 and 21ºC; if not, refrigerate for about 30
minutes before rolling and folding."
            },
            {
              "@type": "HowToStep",
              "text": "On a generously floured work surface, roll dough into a roughly 10 by 15 inch rectangle. Fold the
10-inch sides to the center, then close the newly formed packet like a book (a book fold). Divide
in half with a sharp knife or bench scraper. Dough temperature should still be somewhere between 18
and 21ºC; if not, refrigerate for about 30 minutes before proceeding2."
            },
            {
              "@type": "HowToStep",
              "text": "Roll one piece into a 14-inch circle; this size allows ample room to line the pie plate, with
enough overhang to form a generous border. Transfer to a 9-inch pie plate. Dust off excess flour
with a pastry brush, using it to nestle dough into the very corners of the pan. With scissors or
kitchen shears, trim the edge so that it overhangs by 1 1/4 inches all around. Fold overhang over
itself to create a thick border that sits on the top edge of the pie plate, not below. Crimp or
shape crust as desired. Repeat with remaining dough. Wrap with plastic and refrigerate at least 2
hours and up to overnight. Use as directed in your favorite recipe."
            },
            {
              "@type": "HowToStep",
              "text": "For a solid top crust, roll remaining dough as before; for a lattice-top pie, roll into a 10 by
15-inch rectangle instead. Transfer to a baking sheet or parchment-lined cutting board. Wrap both
portions in plastic and refrigerate at least 2 hours and up to overnight. Use as directed in your
favorite recipe; after filling the pie and sealing the crusts together, refrigerate 30 minutes
before baking."
            },
            {
              "@type": "HowToStep",
              "text": "Preheat the oven to 180-200ºC with rack set in the lower-middle position. Scrunch up a piece of
baking paper(aluminium foil also works, but tends to stick), and fill the pie evenly with baking
beads, rice, or dried beans."
            },
            {
              "@type": "HowToStep",
              "text": "Bake for about 60-75 minutes until set and golden around the edges. Remove the baking beads, and
bake for another 5 minutes until the pastry is golden and dry to the touch."
            }
          ]
        }
    </script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-308113-3', 'auto');
  ga('send', 'pageview');

</script>

</head>

<body class="home blog">
  <div>
    <header class="site-header">
      <nav class="navbar navbar-expand-lg navbar-default" role="navigation">
        <div class="container">
          <div class="row" style="width: 100%;">
            <div class="site-navigation-inner col-sm-12">
              <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <i class="social fas fa-ellipsis-v"></i>
              </button>

              <div class="collapse navbar-collapse navbar-ex1-collapse" id="navbarSupportedContent" style="float: left;">
                <ul id="menu-all-pages" class="nav navbar-nav mr-auto" style="padding: 20px;">
                  <li class="menu-item"><a href="/" >Home

<i class=" fa-lg" style=""></i></a></li>
                  <li class="menu-item"><a href="/about" >About

<i class=" fa-lg" style=""></i></a></li>
                  <li class="menu-item"><a href="/cv" >CV

<i class=" fa-lg" style=""></i></a></li>
                  <li class="menu-item"><a href="/recipes" >recipes

<i class=" fa-lg" style=""></i></a></li>
                  <li class="menu-item"><a href="/posts" >posts

<i class=" fa-lg" style=""></i></a></li>
                </ul>
              </div>
              <div class="social">
                <a href="https://scholar.google.com/citations?user=pEj09c4AAAAJ" title="Google Scholar" >

<i class="ai ai-google-scholar fa-lg" style="font-size: 1.6rem;"></i></a>
                <a href="http://github.com/josh146" title="GitHub" >

<i class="fab fa-github fa-lg" style=""></i></a>
                <a href="https://linkedin.com/pub/josh-izaac/104/9bb/6a2" title="LinkedIn" >

<i class="fab fa-linkedin fa-lg" style=""></i></a>
                <a data-email="ca.azi@hsoj:otliam" data-title="Email" title="You need javascript enabled to view this email" class="email">

<i class="fas fa-envelope fa-lg" style=""></i></a>
                <a href="/feeds/rss.xml" title="Feed" >

<i class="fas fa-rss fa-lg" style=""></i></a>
               <a href="#" onClick="const ninja=document.querySelector('ninja-keys');ninja.open();"><i class="fas fa-search"></i></a>
              </div>
            </div>
          </div>
        </div>
      </nav><!-- .site-navigation -->


  </header><!-- #masthead -->
  </div>
    <div id="content" class="site-content">
      <div class="container main-content-area">
        <div class="row">
          <div class="main-content-inner col-sm-12 col-md-12">
            <div id="primary" class="content-area">
              <div id="main" class="site-main" role="main">
                <div class="article-container">

<style>
@media (min-width: 768px) {
    .recipe-ingredients {
        position: -webkit-sticky;
        position: sticky;
        top: 20px;
        z-index: 10;
        max-height: calc(100vh - 40px);
        overflow-y: auto;
    }
    .article-container {
        overflow: unset;
    }
}
</style>

<article class="recipe-container">

    <header class="recipe-header">

        <div class="hero-image" style="background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('/images/recipes/rough-puff.jpg');">
            <h1 class="recipe-title hero-text">Rough puff pastry</h1>
        </div>

        <div class="recipe-meta-badges">
                <span>TIME</span><span>1.5 hours</span>
                <span>MAKES</span><span id="servings-badge" data-original="585g of pastry. Makes enough for two single-crusted pie, or one double-crusted pie."><span class="scalable" data-base="585.0">585</span>g of pastry. Makes enough for two single-crusted pie, or one double-crusted pie.</span>
                <span class="scale-label">PORTION</span>
                <div class="scale-controls">
                    <a class="scale-btn" onclick="scaleRecipe(0.5, this)">0.5x</a>
                    <a class="scale-btn active" onclick="scaleRecipe(1, this)">1x</a>
                    <a class="scale-btn" onclick="scaleRecipe(2, this)">2x</a>
                    <a class="scale-btn" onclick="scaleRecipe(3, this)">3x</a>
                </div>
        </div>
<!--         <div class="github-link">
            <a href="https://github.com/josh146/josh146.github.io/blob/source/content/recipes/rough-puff.md"
               target="_blank">
               VIEW SOURCE
            </a>
        </div> -->

        <div class="recipe-intro">
            <p>Rough puff (also known as blitz puff) is a method of approximating puff pastry where the butter is incorporated <em>directly</em> into the dough using large sheets of butter. The dough will start off looking very rough and shaggy, but by the time you have rolled it out and performed several folds, it will be smooth and cohesive.</p>
<p>Rough puff is great when a recipe calls for puff pastry, but clear separation between the layers is
unecessary — as a result it is my go-to pastry for an old-fashioned American flaky fruit pie.</p>
<p>To scale this recipe up and down, simply remember the ratio 2:2:1 — 2 parts flour, 2 parts butter,
1 part water. For example, to make 1kg of rough puff pastry, simply use 400g of flour, 400g of
butter, and 200g of water.</p>

        </div>
    </header>


    <div class="recipe-grid">
        <section class="recipe-ingredients">
            <h2>INGREDIENTS</h2>
            
<ul>
<li><span class="scalable" data-base="225.0">225</span>g plain flour <span class="paren">(plus more for dusting)</span></li>
<li><span class="scalable" data-base="225.0">225</span>g unsalted butter <span class="paren">(cold, cut into <span class="scalable" data-base="0.5">1/2</span> inch cubes)</span></li>
<li><span class="scalable" data-base="115.0">115</span>g cold tap water</li>
<li><span class="scalable" data-base="15.0">15</span>g <span class="paren">(<span class="scalable" data-base="1.0">1</span> tbsp)</span> sugar</li>
<li><span class="scalable" data-base="1.0">1</span> tsp <span class="paren">(<span class="scalable" data-base="4.0">4</span>g)</span> kosher salt</li>
</ul>

        </section>

        <section class="recipe-method">
            <h2>STEPS</h2>
            
<h3>Mixing the dough</h3>
<ol>
<li>
<p>For the Dough: Whisk flour, sugar, and salt together in a medium bowl. Toss the cubed butter with
the flour mixture to break up the pieces. With your fingertips, smash each cube flat into a
sheet — no rubbing or cutting<sup id="sf-rough-puff-pastry-1-back"><a class="simple-footnote" href="#sf-rough-puff-pastry-1" title="You can also use a stand mixer with the paddle attachement on
the butter and flour mixture until an uneven crumb mixture forms with large pieces of butter.
However, you won’t get as flaky a result.">1</a></sup>.</p>
</li>
<li>
<p>Stir in water, then knead dough against the sides of the bowl until it comes together in a shaggy
ball. Dough temperature should register between 18 and 21ºC; if not, refrigerate for about 30
minutes before rolling and folding.</p>
</li>
</ol>
<h3>Folding</h3>
<ol>
<li>On a generously floured work surface, roll dough into a roughly 10 by 15 inch rectangle. Fold the
10-inch sides to the center, then close the newly formed packet like a book (a book fold). Divide
in half with a sharp knife or bench scraper. Dough temperature should still be somewhere between 18
and 21ºC; if not, refrigerate for about 30 minutes before proceeding<sup id="sf-rough-puff-pastry-2-back"><a class="simple-footnote" href="#sf-rough-puff-pastry-2" title="You can perform additional
folds here if you want more layers. For example: 1 letter fold, and 2 book folds, with 15-30
minutes of chilling between each fold.">2</a></sup>.</li>
</ol>
<h3>Single crusted pies</h3>
<ol>
<li>Roll one piece into a 14-inch circle; this size allows ample room to line the pie plate, with
enough overhang to form a generous border. Transfer to a 9-inch pie plate. Dust off excess flour
with a pastry brush, using it to nestle dough into the very corners of the pan. With scissors or
kitchen shears, trim the edge so that it overhangs by 1 1/4 inches all around. Fold overhang over
itself to create a thick border that sits on the top edge of the pie plate, not below. Crimp or
shape crust as desired. Repeat with remaining dough. Wrap with plastic and refrigerate at least 2
hours and up to overnight. Use as directed in your favorite recipe.</li>
</ol>
<h3>Double crusted pies</h3>
<ol>
<li>For a solid top crust, roll remaining dough as before; for a lattice-top pie, roll into a 10 by
15-inch rectangle instead. Transfer to a baking sheet or parchment-lined cutting board. Wrap both
portions in plastic and refrigerate at least 2 hours and up to overnight. Use as directed in your
favorite recipe; after filling the pie and sealing the crusts together, refrigerate 30 minutes
before baking.</li>
</ol>
<h3>Blind baking</h3>
<ol>
<li>
<p>Preheat the oven to 180-200ºC with rack set in the lower-middle position. Scrunch up a piece of
baking paper(aluminium foil also works, but tends to stick), and fill the pie evenly with baking
beads, rice, or dried beans.</p>
</li>
<li>
<p>Bake for about 60-75 minutes until set and golden around the edges. Remove the baking beads, and
bake for another 5 minutes until the pastry is golden and dry to the touch.</p>
</li>
</ol>

        </section>
    </div>

    <div class="recipe-notes">
        <h2>NOTES</h2>
        
<p>The dough can be made ahead of time and refrigerated for up to 24 hours before use. To store it for
longer than that, the dough can be frozen as a block, rolled, or shaped in a pan. If frozen as a
block, dough will still need to rest/relax for at least 2 hours after rolling and shaping.</p><script charset="utf-8" src="//platform.twitter.com/widgets.js"></script>
        <ol class="simple-footnotes"><li id="sf-rough-puff-pastry-1"><footnote>You can also use a stand mixer with the paddle attachement on
the butter and flour mixture until an uneven crumb mixture forms with large pieces of butter.
However, you won’t get as flaky a result.</footnote> <a class="simple-footnote-back" href="#sf-rough-puff-pastry-1-back">↩︎</a></li><li id="sf-rough-puff-pastry-2"><footnote>You can perform additional
folds here if you want more layers. For example: 1 letter fold, and 2 book folds, with 15-30
minutes of chilling between each fold.</footnote> <a class="simple-footnote-back" href="#sf-rough-puff-pastry-2-back">↩︎</a></li></ol>

    </div>

    <div class="related">
        <h2>Related</h2>
        <div id="recipe-gallery" class="recipe-gallery">
            <div class="recipe-card">
                <a href="/recipes/pate-feuilletee-puff-pastry/">
                    <div class="card-image-wrapper">
                        <img src="/images/recipes/puff-pastry.jpg" alt="Pâte feuilletée (puff pastry)">
                    </div>

                    <div class="card-details">
                        <h3>Pâte feuilletée (puff pastry)</h3>
                    </div>
                </a>
            </div>
            <div class="recipe-card">
                <a href="/recipes/apple-tarte-tatin-with-creme-diplomat/">
                    <div class="card-image-wrapper">
                        <img src="/images/recipes/default_recipe2.png" alt="Apple tarte tatin with crème diplomat">
                    </div>

                    <div class="card-details">
                        <h3>Apple tarte tatin with crème diplomat</h3>
                    </div>
                </a>
            </div>
            <div class="recipe-card">
                <a href="/recipes/blueberry-pie/">
                    <div class="card-image-wrapper">
                        <img src="/images/recipes/blueberry-pie-baked.jpg" alt="Blueberry pie">
                    </div>

                    <div class="card-details">
                        <h3>Blueberry pie</h3>
                    </div>
                </a>
            </div>
        </div>
    </div>

</article>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const ingredientContainer = document.querySelector('.recipe-ingredients');

    if (ingredientContainer) {
        ingredientContainer.addEventListener('click', function(e) {
            const li = e.target.closest('li');

            // If we didn't click inside an li, or we clicked the container padding, ignore.
            if (!li) return;

            // check if the user clicked an interactive element
            if (e.target.closest('a')) {
                return;
            }

            li.classList.toggle('done');
        });
    }
});
</script>

<script>
function scaleRecipe(multiplier, btnElement) {
    document.querySelectorAll('.scale-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    btnElement.classList.add('active');

    document.querySelectorAll('.scalable').forEach(el => {
        const baseVal = parseFloat(el.dataset.base);
        if (!isNaN(baseVal)) {
            const newVal = baseVal * multiplier;

            // Remove trailing zeros (e.g. 2.50 -> 2.5)
            // parseFloat(num.toFixed(2)) handles rounding to 2 decimal places
            // and stripping unnecessary zeros automatically.
            el.innerText = parseFloat(newVal.toFixed(2));
        }
    });


    // update Servings Badge
    const servBadge = document.getElementById('servings-badge');
    servBadge.querySelectorAll('.scalable').forEach(el => {
        const baseVal = parseFloat(el.dataset.base);
        if (!isNaN(baseVal)) {
            const newVal = baseVal * multiplier;

            // Remove trailing zeros (e.g. 2.50 -> 2.5)
            // parseFloat(num.toFixed(2)) handles rounding to 2 decimal places
            // and stripping unnecessary zeros automatically.
            el.innerText = parseFloat(newVal.toFixed(2));
        }

    });
}
</script>

<script>
document.querySelectorAll('.recipe-method li').forEach(li => {
    li.addEventListener('click', function() {
        const parent = this.parentNode;

        // if clicking the already highlighted item, turn off focus mode
        if (this.classList.contains('highlighted')) {
            this.classList.remove('highlighted');
            parent.classList.remove('focus-active');
        } else {
            // remove highlight from others
            parent.querySelectorAll('li').forEach(el => el.classList.remove('highlighted'));

            // highlight this one
            this.classList.add('highlighted');
            parent.classList.add('focus-active');
        }
    });
});
</script>


<script>
// Add hover preview for component links
document.querySelectorAll('.component-link').forEach(link => {
    const isDesktop = window.matchMedia("(pointer: fine)").matches;

    if (isDesktop) {
        link.addEventListener('mouseenter', async function() {
            // Create tooltip if it doesn't exist
            let tooltip = document.getElementById('recipe-preview-tooltip');
            if (!tooltip) {
                tooltip = document.createElement('div');
                tooltip.id = 'recipe-preview-tooltip';
                document.body.appendChild(tooltip);
            }

            // Position it
            const rect = this.getBoundingClientRect();
            tooltip.style.left = `${rect.left}px`;
            tooltip.style.top = `${rect.bottom + 5}px`;
            tooltip.style.display = 'block';
            tooltip.innerHTML = 'Loading...';

            // Fetch the linked page
            try {
                const response = await fetch(this.href);
                const text = await response.text();

                // Parse the response to grab just the ingredients list
                const parser = new DOMParser();
                const doc = parser.parseFromString(text, 'text/html');

                // Assuming your ingredients are in a container with class 'recipe-ingredients'
                const ingredients = doc.querySelector('.recipe-ingredients ul').innerHTML;
                const title = doc.querySelector('h1').innerText;
                const imageURL = extractBackgroundUrl(doc, '.hero-image');

                tooltip.innerHTML = `<strong>${title}</strong><img src=${imageURL} />`;
                // tooltip.innerHTML = `<strong>${title}</strong><img src=${imageURL} /><ul>${ingredients}</ul>`;
            } catch (e) {
                tooltip.style.display = 'none';
                console.log('Error loading preview.');
            }
        });

        link.addEventListener('mouseleave', () => {
            const tooltip = document.getElementById('recipe-preview-tooltip');
            if (tooltip) tooltip.style.display = 'none';
        });
    } else {
        console.log("Not a fine pointer device, 'mouseenter' event listener not attached.");
    }
});

function extractBackgroundUrl(doc, el) {
    const element = doc.querySelector(el);
    const backgroundImage = element.style.backgroundImage;
    const url = backgroundImage.slice(61, -1).replace(/['"]/g, "");
    return url;
}
</script>

<script>
// Blueprint recipes
document.addEventListener('DOMContentLoaded', () => {
    const yamlBlock = document.getElementById('variation-yaml');
    if (!yamlBlock) return;

    const rawText = yamlBlock.innerText;
    const variations = {};

    // Split by the separator "---" to get each theme block
    const blocks = rawText.split('---');

    blocks.forEach(block => {
        if (!block.trim()) return; // Skip empty blocks

        const currentThemeData = {};
        let themeName = null;

        // Split by lines
        const lines = block.trim().split('\n');

        lines.forEach(line => {
            // Find the first colon to separate Key and Value
            const separatorIndex = line.indexOf(':');
            if (separatorIndex === -1) return; // Skip invalid lines

            const key = line.substring(0, separatorIndex).trim();
            const value = line.substring(separatorIndex + 1).trim();

            if (key === 'Theme') {
                themeName = value;
            } else {
                currentThemeData[key] = value;
            }
        });

        if (themeName) {
            variations[themeName] = currentThemeData;
        }
    });

    // build the UI Controls
    const controlContainer = document.getElementById('variation-controls');
    controlContainer.innerHTML = '<span class="vibe-label">Choose your Vibe</span>';

    const btnGroup = document.createElement('div');
    btnGroup.className = 'vibe-buttons';

    // create a "Blueprint" (Reset) button
    const resetBtn = document.createElement('button');
    resetBtn.innerText = 'Blueprint';
    resetBtn.className = 'vibe-btn active';
    resetBtn.id = 'Blueprint';
    resetBtn.onclick = () => applyVariation('Blueprint', resetBtn);
    btnGroup.appendChild(resetBtn);

    // create buttons for each theme
    Object.keys(variations).forEach(theme => {
        const btn = document.createElement('button');
        btn.innerText = theme;
        btn.className = 'vibe-btn';
        btn.id = theme;
        btn.onclick = () => applyVariation(theme, btn);
        btnGroup.appendChild(btn);
    });

    controlContainer.appendChild(btnGroup);

    let blueprintsInitialized = false;

    function applyVariation(themeName, clickedBtn) {
        const url = new URL(window.location);
        url.searchParams.set('vibe', themeName);
        window.history.replaceState({}, '', url);

        // update Buttons Visual State
        document.querySelectorAll('.vibe-btn').forEach(b => b.classList.remove('active'));
        if (clickedBtn) clickedBtn.classList.add('active');

        // Find placeholders in the DOM
        if (!blueprintsInitialized) {
            const contentArea = document.querySelector('.recipe-container');
            if (contentArea) {
                const walker = document.createTreeWalker(contentArea, NodeFilter.SHOW_TEXT, null, false);
                let node;
                // split the string so Pelican/Jinja doesn't try to parse it
                const startBracket = '{' + '{';

                while(node = walker.nextNode()) {
                    if (node.nodeValue.includes(startBracket)) {
                        const parent = node.parentNode;
                        // Save original text if not already saved
                        if (!parent.hasAttribute('data-blueprint')) {
                            parent.setAttribute('data-blueprint', parent.innerHTML);
                            parent.classList.add('dynamic-slot');
                        }
                    }
                }
                blueprintsInitialized = true;
            }
        }

        // the update loop
        const slots = document.querySelectorAll('.dynamic-slot');

        slots.forEach(slot => {
            let htmlToUpdate = slot.getAttribute('data-blueprint');

            // Reset parent styling (Assume standard item first)
            if (slot.parentElement && slot.parentElement.tagName === 'LI') {
                slot.parentElement.classList.remove('is-sublist-parent');
            }

            // apply defined replacements
            if (themeName && variations[themeName]) {
                const replacements = variations[themeName];

                Object.keys(replacements).forEach(key => {
                    const regex = new RegExp('{' + '{' + key + '}' + '}', 'g');
                    let value = replacements[key];

                    // If this key exists in the current theme, replace it
                    if (value) {
                        if (key.includes('list')) {
                            // Multi-item List Logic
                            const items = value.split(';').map(item => `<li>${item.trim()}</li>`).join('');
                            value = `<ul class="dynamic-sublist">${items}</ul>`;
                        } else if (key.includes('step')) {
                            // step logic
                            value = `<ol class="dynamic-sublist"><li><strong>${value}</strong></li></ol>`;

                        } else {
                            // Standard Single Item
                            value = `<strong>${value}</strong>`;
                        }

                        htmlToUpdate = htmlToUpdate.replace(regex, value);
                    }
                });
            }

            // This handles "Blueprint Mode" AND any missing variables in specific themes
            const pillRegex = new RegExp('{' + '{([a-zA-Z0-9_]+?)}' + '}', 'g');

            htmlToUpdate = htmlToUpdate.replace(pillRegex, (match, key) => {
                const cleanName = key.replace(/_/g, ' ');

                if (key.includes('list') || key.includes('step')) {
                    return `<span class="variable-pill variable-list">${cleanName}</span>`;
                }
                return `<span class="variable-pill">${cleanName}</span>`;
            });

            // parens styling
            if (slot.closest('ul') || slot.closest('.recipe-ingredients')) {
                htmlToUpdate = htmlToUpdate.replace(/\(([^)<]+)\)(?![^<]*>)/g, '<span class="paren">($1)</span>');
                }

            // Render
            slot.innerHTML = htmlToUpdate;
            slot.classList.remove('changed');
            void slot.offsetWidth;
            slot.classList.add('changed');
        });
    }

    const urlParams = new URLSearchParams(window.location.search);
    const themeName = urlParams.get('vibe');

    if (Object.keys(variations).includes(themeName)) {
        applyVariation(themeName, document.getElementById(themeName));
    } else {
        applyVariation('Blueprint', document.querySelector('.vibe-btn.active'));
    }
});
</script>

                </div>
              </div><!-- #main -->
          </div><!-- #primary -->
        </div>
      </div><!-- close .row -->
    </div><!-- close .container -->
  </div><!-- close .site-content -->




  <div id="footer-area">
    <footer id="colophon" class="site-footer" role="contentinfo">
      <div class="site-info container">
        <div class="row">
                    <div class="copyright col-md-12">
                    This site uses the <a href="https://github.com/limbenjamin/voce">voce</a> theme by <a href="//limbenjamin.com/">Benjamin Lim</a><br />
                    &copy; 2025 <a href="../..">Josh Izaac</a> </div>
        </div>
      </div><!-- .site-info -->
      <div class="scroll-to-top" style="display: none;"><i class="fa fa-angle-up"></i></div><!-- .scroll-to-top -->
    </footer><!-- #colophon -->
  </div>


  <script type="text/javascript">
    window.addEventListener('load', function(){
      var e = document.querySelectorAll(".email");
      for (var i = 0; i < e.length; i++) {
        var email = e[i].getAttribute("data-email")
        var title = e[i].getAttribute("data-title")
        if (email){
          e[i].href = email.split("").reverse().join("");
          e[i].removeAttribute("data-email");
          e[i].removeAttribute("data-title");
          e[i].removeAttribute("class");
          if (title){
            e[i].setAttribute("title", title);
          }
          else{
            e[i].removeAttribute("title");
          }
        }
      }
    })
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
        const ninja = document.querySelector('ninja-keys');

        if (ninja) {
            // 1. Load your JSON index
            fetch('/search.json')
                .then(response => response.json())
                .then(data => {
                    // 2. Transform into Ninja Keys format
                    const menuItems = data.map(item => ({
                        id: item.url,
                        title: item.title,
                        section: item.type, // Groups results by 'Recipe' vs 'Page'
                        keywords: item.keywords,
                        handler: () => {
                            window.location.href = item.url;
                        }
                    }));

                    // 3. Add static actions (Optional)
                    // e.g., Dark Mode toggle, Home button
                    menuItems.push({
                        id: 'home',
                        title: 'Go to Home',
                        section: 'Navigation',
                        hotkey: 'cmd+h',
                        handler: () => { window.location.href = '/'; }
                    });

                    // 4. Give data to Ninja Keys
                    ninja.data = menuItems;
                })
                .catch(err => console.error("Failed to load search index:", err));
        }
    });
  </script>


  <ninja-keys placeholder="Search..." hideBreadcrumbs></ninja-keys>
</body>
</html>