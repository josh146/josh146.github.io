<!DOCTYPE html>
<html lang="en">

<head>

  <title>Blue moon ice cream recipe | josh iza.ac</title>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Josh Izaac">
  <meta name="description" content="I’ve always wondered why lemon ice cream is so rare. Sure, everyone sells lemon sorbet, but citrus-flavoured ice creams are the perfect combination of bright, sour, and creamy. This recipe is a recreation of blue moon gelato from Gusto Gelato, one of my favourite gelateria’s...
">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png">
  <link rel="manifest" href="/images/favicon/site.webmanifest">
  <link rel="mask-icon" href="/images/favicon/safari-pinned-tab.svg" color="#5bbad5">
  <link rel="shortcut icon" href="/images/favicon/favicon.ico">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-config" content="/images/favicon/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">

  <!-- Facebook Meta Tags -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Blue moon ice cream recipe | josh iza.ac">
  <meta property="og:url" content=" recipes/blue-moon-ice-cream/ ">
  <meta property="og:description" content="I’ve always wondered why lemon ice cream is so rare. Sure, everyone sells lemon sorbet, but citrus-flavoured ice creams are the perfect combination of bright, sour, and creamy. This recipe is a recreation of blue moon gelato from Gusto Gelato, one of my favourite gelateria’s...
">
  <meta property="og:image" content="/images/recipes/blue-moon.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta property="twitter:domain" content="../..">
  <meta property="twitter:url" content=" recipes/blue-moon-ice-cream/ ">
  <meta name="twitter:title" content="Blue moon ice cream recipe | josh iza.ac">
  <meta name="twitter:description" content="I’ve always wondered why lemon ice cream is so rare. Sure, everyone sells lemon sorbet, but citrus-flavoured ice creams are the perfect combination of bright, sour, and creamy. This recipe is a recreation of blue moon gelato from Gusto Gelato, one of my favourite gelateria’s...
">
  <meta name="twitter:image" content="/images/recipes/blue-moon.jpg">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
  <link rel="stylesheet" href="../../theme/css/font.css" type="text/css" media="all">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
  <link rel="stylesheet" href="../../theme/css/style.css" type="text/css" media="all">
  <link rel="stylesheet" href="../../theme/css/recipe_gallery.css" type="text/css" media="all">
  <link rel="stylesheet" href="../../theme/css/pygments.css" type="text/css" media="all">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">

  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.6.347/pdf.min.js"></script>

  <script type="module" src="https://unpkg.com/ninja-keys?module"></script>


<script src="https://code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="../../theme/js/functions.js"></script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Amatic+SC:wght@700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=DM+Mono&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Syne+Mono&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Fira+Mono&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Fira+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">

  <link href="http://iza.ac/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="josh iza.ac Full Atom Feed" />

      <meta name="keywords" content="keywords, pytorch, quantum, gradients, tensorflow">

    <link rel="stylesheet" href="../../theme/css/recipe.css">
    <script type="application/ld+json">
        {
          "@context": "https://schema.org/",
          "@type": "Recipe",
          "name": "Blue moon ice cream",
          "image": [
            "../..//images/recipes/blue-moon.jpg"
          ],
          "author": {
            "@type": "Person",
            "name": "Josh Izaac"
          },
          "datePublished": "2025-12-22 00:00:00+08:00",
          "description": "I’ve always wondered why lemon ice cream is so rare. Sure, everyone sells lemon sorbet, but citrus-flavoured ice creams are the perfect combination of...",

          "totalTime": "PT1 hour",

          "recipeYield": "1L of ice cream and 1/2 a cup of blueberry syrup servings",

          "recipeIngredient": [
            "225g frozen blueberries",
            "170g sugar",
            "1/4 tsp (1g) kosher salt",
            "1/2 tsp orange blossom water (or other aromatics, such as vanilla essence, almond extract, rose water, or orange blossom water)1.",
            "Lemon rind from 2 lemons",
            "130g sugar",
            "250ml whole milk",
            "250ml heavy cream",
            "250ml double cream2",
            "230g good quality white chocolate (finely chopped)",
            "5 large egg yolks",
            "1 tsp vanilla extract"
          ],

          "recipeInstructions": [
            {
              "@type": "HowToStep",
              "text": "Combine blueberries, lemon juice, sugar, and salt in a 2L stainless steel saucier. Make note of
the filled saucier’s weight at this stage so the reduction can be tracked on the scale. Mash the
blueberries with a fork or metal spatula."
            },
            {
              "@type": "HowToStep",
              "text": "Place over medium heat and bring to a boil, continuously stirring and scraping along the bottom
and sides of the saucier with a flexible, heat-resistant spatula. This should take no longer than 5
minutes; if it seems to be moving too slowly, simply increase the heat."
            },
            {
              "@type": "HowToStep",
              "text": "Once the mixture begins to boil, continue cooking until reduced by 115g for a thin, saucy ribbon
or 140g for a thick, gooey ribbon. This phase should take about 6 minutes; while it’s natural for
the timing to vary from one stovetop to the next, a significant delay may indicate the heat is too low."
            },
            {
              "@type": "HowToStep",
              "text": "Strain the syrup into a heat-safe container and stir in the orange blossom water (or other
aromatics; see note). If desired, season with an additional pinch of salt, bearing in mind the
syrup will seem less sweet when frozen. Cover and refrigerate until no warmer than 4ºC."
            },
            {
              "@type": "HowToStep",
              "text": "Add the sugar, milk, lemon rind, 1 cup of double cream and a pinch of salt to the saucepan and
warm the mixture. Once warm, turn off the stove, and cover and steep for at least an hour, or until
you are satisfied with the lemon flavor."
            },
            {
              "@type": "HowToStep",
              "text": "Finely chop the white chocolate, and place it in a large glass bowl."
            },
            {
              "@type": "HowToStep",
              "text": "In a separate medium-sized bowl, whisk together the egg yolks, then gradually add some of the
lemon-infused cream mixture, whisking constantly as you pour in the warm cream. Pour the warmed egg
yolks back into the saucepan."
            },
            {
              "@type": "HowToStep",
              "text": "Cook over low heat, stirring constantly and scraping the bottom with a heat-resistant spatula
until the custard thickens enough to coat the spatula. Strain the custard into the white chocolate,
and stir until the chocolate is completely melted."
            },
            {
              "@type": "HowToStep",
              "text": "Add the remaining 1 cup of heavy cream and 1 tsp vanilla extract. Stir to combine. Chill
thoroughly in the fridge, then freeze in your ice cream maker according to the manufacturer’s
instructions. While churning, place a flat glass/pyrex tray into the freezer."
            },
            {
              "@type": "HowToStep",
              "text": "Stir the syrup until viscous. Place a third of the ice cream into the chilled container, and
layer/drizzle the syrup using spoon. Place another third of the ice cream on top, as well as
another drizzle of syrup. Finally, finish by placing the final third of the ice cream, and by using
a knife or spatula to gently swirl and ribbon the syrup."
            },
            {
              "@type": "HowToStep",
              "text": "Return the container to the freezer to allow the ice cream to set, ~5-6 hours. Any remaining
syrup can be used as a sauce."
            }
          ]
        }
    </script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-308113-3', 'auto');
  ga('send', 'pageview');

</script>

</head>

<body class="home blog">
  <div>
    <header class="site-header">
      <nav class="navbar navbar-expand-lg navbar-default" role="navigation">
        <div class="container">
          <div class="row" style="width: 100%;">
            <div class="site-navigation-inner col-sm-12">
              <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <i class="social fas fa-ellipsis-v"></i>
              </button>

              <div class="collapse navbar-collapse navbar-ex1-collapse" id="navbarSupportedContent" style="float: left;">
                <ul id="menu-all-pages" class="nav navbar-nav mr-auto" style="padding: 20px;">
                  <li class="menu-item"><a href="/" >Home

<i class=" fa-lg" style=""></i></a></li>
                  <li class="menu-item"><a href="/about" >About

<i class=" fa-lg" style=""></i></a></li>
                  <li class="menu-item"><a href="/cv" >CV

<i class=" fa-lg" style=""></i></a></li>
                  <li class="menu-item"><a href="/recipes" >recipes

<i class=" fa-lg" style=""></i></a></li>
                  <li class="menu-item"><a href="/posts" >posts

<i class=" fa-lg" style=""></i></a></li>
                </ul>
              </div>
              <div class="social">
                <a href="https://scholar.google.com/citations?user=pEj09c4AAAAJ" title="Google Scholar" >

<i class="ai ai-google-scholar fa-lg" style="font-size: 1.6rem;"></i></a>
                <a href="http://github.com/josh146" title="GitHub" >

<i class="fab fa-github fa-lg" style=""></i></a>
                <a href="https://linkedin.com/pub/josh-izaac/104/9bb/6a2" title="LinkedIn" >

<i class="fab fa-linkedin fa-lg" style=""></i></a>
                <a data-email="ca.azi@hsoj:otliam" data-title="Email" title="You need javascript enabled to view this email" class="email">

<i class="fas fa-envelope fa-lg" style=""></i></a>
                <a href="/feeds/rss.xml" title="Feed" >

<i class="fas fa-rss fa-lg" style=""></i></a>
               <a href="#" onClick="const ninja=document.querySelector('ninja-keys');ninja.open();"><i class="fas fa-search"></i></a>
              </div>
            </div>
          </div>
        </div>
      </nav><!-- .site-navigation -->


  </header><!-- #masthead -->
  </div>
    <div id="content" class="site-content">
      <div class="container main-content-area">
        <div class="row">
          <div class="main-content-inner col-sm-12 col-md-12">
            <div id="primary" class="content-area">
              <div id="main" class="site-main" role="main">
                <div class="article-container">

<style>
@media (min-width: 768px) {
    .recipe-ingredients {
        position: -webkit-sticky;
        position: sticky;
        top: 20px;
        z-index: 10;
        max-height: calc(100vh - 40px);
        overflow-y: auto;
    }
    .article-container {
        overflow: unset;
    }
}
</style>

<article class="recipe-container">

    <header class="recipe-header">

        <div class="hero-image" style="background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('/images/recipes/blue-moon.jpg');">
            <h1 class="recipe-title hero-text">Blue moon ice cream</h1>
        </div>

        <div class="recipe-meta-badges">
                <span>TIME</span><span>1 hour</span>
                <span>MAKES</span><span id="servings-badge" data-original="1L of ice cream and 1/2 a cup of blueberry syrup"><span class="scalable" data-base="1.0">1</span>L of ice cream and <span class="scalable" data-base="0.5">1/2</span> a cup of blueberry syrup</span>
                <span class="scale-label">PORTION</span>
                <div class="scale-controls">
                    <a class="scale-btn" onclick="scaleRecipe(0.5, this)">0.5x</a>
                    <a class="scale-btn active" onclick="scaleRecipe(1, this)">1x</a>
                    <a class="scale-btn" onclick="scaleRecipe(2, this)">2x</a>
                    <a class="scale-btn" onclick="scaleRecipe(3, this)">3x</a>
                </div>
        </div>
<!--         <div class="github-link">
            <a href="https://github.com/josh146/josh146.github.io/blob/source/content/recipes/blue-moon-ice-cream.md"
               target="_blank">
               VIEW SOURCE
            </a>
        </div> -->

        <div class="recipe-intro">
            <p>I’ve always wondered why lemon ice cream is so rare. Sure, everyone sells lemon sorbet, but
citrus-flavoured ice creams are the perfect combination of bright, sour, and creamy. </p>
<p>This recipe is a recreation of <a href="https://www.instagram.com/p/DLWBC3qztZe/">blue moon gelato from Gusto Gelato</a>, one of my favourite gelateria’s in Perth. A rich white
chocolate-infused ice cream base with a blueberry ripple, the understated white chocolate provides
a base that is elevated by the lemon and blueberry, leading to a fresh, vibrant ice cream that is
not at all heavy on the palate.</p>
<p>The white chocolate ice cream base is adapted from <a href="https://www.davidlebovitz.com/caramelized-white-chocolate-ice/">David Lebovitz’s caramelized white chocolate ice
cream</a>, while the blueberry ripple
is based on <a href="https://www.seriouseats.com/how-to-make-a-fresh-fruit-swirl-for-ice-cream">Stella Parks fresh-fruit ice cream swirl recipe</a>.</p>

        </div>
    </header>


    <div class="recipe-grid">
        <section class="recipe-ingredients">
            <h2>INGREDIENTS</h2>
            
<p>** Blueberry swirl**</p>
<ul>
<li><span class="scalable" data-base="225.0">225</span>g frozen blueberries</li>
<li><span class="scalable" data-base="170.0">170</span>g sugar</li>
<li><span class="scalable" data-base="0.25">1/4</span> tsp <span class="paren">(<span class="scalable" data-base="1.0">1</span>g)</span> kosher salt</li>
<li><span class="scalable" data-base="0.5">1/2</span> tsp orange blossom water <span class="paren">(or other aromatics, such as vanilla essence, almond extract, rose water, or orange blossom water)</span><sup id="sf-blue-moon-ice-cream-1-back"><a class="simple-footnote" href="#sf-blue-moon-ice-cream-1" title="Aromatic ingredients amplify the blueberry’s aroma, offsetting the muting effects of freezing temperatures.">1</a></sup>.</li>
</ul>
<p><strong>Ice cream base</strong></p>
<ul>
<li>Lemon rind from <span class="scalable" data-base="2.0">2</span> lemons</li>
<li><span class="scalable" data-base="130.0">130</span>g sugar</li>
<li><span class="scalable" data-base="250.0">250</span>ml whole milk</li>
<li><span class="scalable" data-base="250.0">250</span>ml heavy cream</li>
<li><span class="scalable" data-base="250.0">250</span>ml double cream<sup id="sf-blue-moon-ice-cream-2-back"><a class="simple-footnote" href="#sf-blue-moon-ice-cream-2" title="Double cream is easy to get in Australia — it is about 48% milk fat. When I’m in Canada, I usually just replace this with heavy cream. The difference is not too noticeable; without the double cream, the texture is slightly less smooth/more icy, but the flavour is better and it coats the tongue less.">2</a></sup></li>
<li><span class="scalable" data-base="230.0">230</span>g good quality white chocolate <span class="paren">(finely chopped)</span></li>
<li><span class="scalable" data-base="5.0">5</span> large egg yolks</li>
<li><span class="scalable" data-base="1.0">1</span> tsp vanilla extract</li>
</ul>

        </section>

        <section class="recipe-method">
            <h2>STEPS</h2>
            
<h3>Blueberry swirl</h3>
<ol>
<li>
<p>Combine blueberries, lemon juice, sugar, and salt in a 2L stainless steel saucier. Make note of
the filled saucier’s weight at this stage so the reduction can be tracked on the scale. Mash the
blueberries with a fork or metal spatula.</p>
</li>
<li>
<p>Place over medium heat and bring to a boil, continuously stirring and scraping along the bottom
and sides of the saucier with a flexible, heat-resistant spatula. This should take no longer than 5
minutes; if it seems to be moving too slowly, simply increase the heat.</p>
</li>
<li>
<p>Once the mixture begins to boil, continue cooking until reduced by 115g for a thin, saucy ribbon
or 140g for a thick, gooey ribbon. This phase should take about 6 minutes; while it’s natural for
the timing to vary from one stovetop to the next, a significant delay may indicate the heat is too low.</p>
</li>
<li>
<p>Strain the syrup into a heat-safe container and stir in the orange blossom water (or other
aromatics; see note). If desired, season with an additional pinch of salt, bearing in mind the
syrup will seem less sweet when frozen. Cover and refrigerate until no warmer than 4ºC.</p>
</li>
</ol>
<h3>Ice cream base</h3>
<p>While the syrup is chilling, get started on the ice cream base.</p>
<ol>
<li>
<p>Add the sugar, milk, lemon rind, 1 cup of double cream and a pinch of salt to the saucepan and
warm the mixture. Once warm, turn off the stove, and cover and steep for at least an hour, or until
you are satisfied with the lemon flavor.</p>
</li>
<li>
<p>Finely chop the white chocolate, and place it in a large glass bowl.</p>
</li>
<li>
<p>In a separate medium-sized bowl, whisk together the egg yolks, then gradually add some of the
lemon-infused cream mixture, whisking constantly as you pour in the warm cream. Pour the warmed egg
yolks back into the saucepan.</p>
</li>
<li>
<p>Cook over low heat, stirring constantly and scraping the bottom with a heat-resistant spatula
until the custard thickens enough to coat the spatula. Strain the custard into the white chocolate,
and stir until the chocolate is completely melted.</p>
</li>
<li>
<p>Add the remaining 1 cup of heavy cream and 1 tsp vanilla extract. Stir to combine. Chill
thoroughly in the fridge, then freeze in your ice cream maker according to the manufacturer’s
instructions. While churning, place a flat glass/pyrex tray into the freezer.</p>
</li>
<li>
<p>Stir the syrup until viscous. Place a third of the ice cream into the chilled container, and
layer/drizzle the syrup using spoon. Place another third of the ice cream on top, as well as
another drizzle of syrup. Finally, finish by placing the final third of the ice cream, and by using
a knife or spatula to gently swirl and ribbon the syrup.</p>
</li>
<li>
<p>Return the container to the freezer to allow the ice cream to set, ~5-6 hours. Any remaining
syrup can be used as a sauce.</p>
</li>
</ol>

        </section>
    </div>

    <div class="recipe-notes">
        <h2>NOTES</h2>
        
<ul>
<li>The amount of sugar, and cooking the blueberries down to reduce the the water content, is
  essential to make sure that the blueberry ripple doesn’t freeze or go icy when setting the ice cream. </li>
</ul><script charset="utf-8" src="//platform.twitter.com/widgets.js"></script>
        <ol class="simple-footnotes"><li id="sf-blue-moon-ice-cream-1"><footnote>Aromatic ingredients amplify the blueberry’s aroma, offsetting the muting effects of freezing temperatures.</footnote> <a class="simple-footnote-back" href="#sf-blue-moon-ice-cream-1-back">↩︎</a></li><li id="sf-blue-moon-ice-cream-2"><footnote>Double cream is easy to get in Australia — it is about 48% milk fat. When I’m in Canada, I usually just replace this with heavy cream. The difference is not too noticeable; without the double cream, the texture is slightly less smooth/more icy, but the flavour is better and it coats the tongue less.</footnote> <a class="simple-footnote-back" href="#sf-blue-moon-ice-cream-2-back">↩︎</a></li></ol>

    </div>

    <div class="related">
        <h2>Related</h2>
        <div id="recipe-gallery" class="recipe-gallery">
            <div class="recipe-card">
                <a href="/recipes/burnt-orange-ice-cream/">
                    <div class="card-image-wrapper">
                        <img src="/images/recipes/default_recipe_dessert.png" alt="Burnt orange ice cream">
                    </div>

                    <div class="card-details">
                        <h3>Burnt orange ice cream</h3>
                    </div>
                </a>
            </div>
            <div class="recipe-card">
                <a href="/recipes/butterscotch-ice-cream/">
                    <div class="card-image-wrapper">
                        <img src="/images/recipes/default_recipe_dessert.png" alt="Butterscotch ice cream">
                    </div>

                    <div class="card-details">
                        <h3>Butterscotch ice cream</h3>
                    </div>
                </a>
            </div>
            <div class="recipe-card">
                <a href="/recipes/english-breakfast-tea-ice-cream/">
                    <div class="card-image-wrapper">
                        <img src="/images/recipes/default_recipe_dessert.png" alt="English breakfast tea ice cream">
                    </div>

                    <div class="card-details">
                        <h3>English breakfast tea ice cream</h3>
                    </div>
                </a>
            </div>
        </div>
    </div>

</article>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const ingredientContainer = document.querySelector('.recipe-ingredients');

    if (ingredientContainer) {
        ingredientContainer.addEventListener('click', function(e) {
            const li = e.target.closest('li');

            // If we didn't click inside an li, or we clicked the container padding, ignore.
            if (!li) return;

            // check if the user clicked an interactive element
            if (e.target.closest('a')) {
                return;
            }

            li.classList.toggle('done');
        });
    }
});
</script>

<script>
function scaleRecipe(multiplier, btnElement) {
    document.querySelectorAll('.scale-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    btnElement.classList.add('active');

    document.querySelectorAll('.scalable').forEach(el => {
        const baseVal = parseFloat(el.dataset.base);
        if (!isNaN(baseVal)) {
            const newVal = baseVal * multiplier;

            // Remove trailing zeros (e.g. 2.50 -> 2.5)
            // parseFloat(num.toFixed(2)) handles rounding to 2 decimal places
            // and stripping unnecessary zeros automatically.
            el.innerText = parseFloat(newVal.toFixed(2));
        }
    });


    // update Servings Badge
    const servBadge = document.getElementById('servings-badge');
    servBadge.querySelectorAll('.scalable').forEach(el => {
        const baseVal = parseFloat(el.dataset.base);
        if (!isNaN(baseVal)) {
            const newVal = baseVal * multiplier;

            // Remove trailing zeros (e.g. 2.50 -> 2.5)
            // parseFloat(num.toFixed(2)) handles rounding to 2 decimal places
            // and stripping unnecessary zeros automatically.
            el.innerText = parseFloat(newVal.toFixed(2));
        }

    });
}
</script>

<script>
document.querySelectorAll('.recipe-method li').forEach(li => {
    li.addEventListener('click', function() {
        const parent = this.parentNode;

        // if clicking the already highlighted item, turn off focus mode
        if (this.classList.contains('highlighted')) {
            this.classList.remove('highlighted');
            parent.classList.remove('focus-active');
        } else {
            // remove highlight from others
            parent.querySelectorAll('li').forEach(el => el.classList.remove('highlighted'));

            // highlight this one
            this.classList.add('highlighted');
            parent.classList.add('focus-active');
        }
    });
});
</script>


<script>
// Add hover preview for component links
document.querySelectorAll('.component-link').forEach(link => {
    const isDesktop = window.matchMedia("(pointer: fine)").matches;

    if (isDesktop) {
        link.addEventListener('mouseenter', async function() {
            // Create tooltip if it doesn't exist
            let tooltip = document.getElementById('recipe-preview-tooltip');
            if (!tooltip) {
                tooltip = document.createElement('div');
                tooltip.id = 'recipe-preview-tooltip';
                document.body.appendChild(tooltip);
            }

            // Position it
            const rect = this.getBoundingClientRect();
            tooltip.style.left = `${rect.left}px`;
            tooltip.style.top = `${rect.bottom + 5}px`;
            tooltip.style.display = 'block';
            tooltip.innerHTML = 'Loading...';

            // Fetch the linked page
            try {
                const response = await fetch(this.href);
                const text = await response.text();

                // Parse the response to grab just the ingredients list
                const parser = new DOMParser();
                const doc = parser.parseFromString(text, 'text/html');

                // Assuming your ingredients are in a container with class 'recipe-ingredients'
                const ingredients = doc.querySelector('.recipe-ingredients ul').innerHTML;
                const title = doc.querySelector('h1').innerText;
                const imageURL = extractBackgroundUrl(doc, '.hero-image');

                tooltip.innerHTML = `<strong>${title}</strong><img src=${imageURL} />`;
                // tooltip.innerHTML = `<strong>${title}</strong><img src=${imageURL} /><ul>${ingredients}</ul>`;
            } catch (e) {
                tooltip.style.display = 'none';
                console.log('Error loading preview.');
            }
        });

        link.addEventListener('mouseleave', () => {
            const tooltip = document.getElementById('recipe-preview-tooltip');
            if (tooltip) tooltip.style.display = 'none';
        });
    } else {
        console.log("Not a fine pointer device, 'mouseenter' event listener not attached.");
    }
});

function extractBackgroundUrl(doc, el) {
    const element = doc.querySelector(el);
    const backgroundImage = element.style.backgroundImage;
    const url = backgroundImage.slice(61, -1).replace(/['"]/g, "");
    return url;
}
</script>

<script>
// Blueprint recipes
document.addEventListener('DOMContentLoaded', () => {
    const yamlBlock = document.getElementById('variation-yaml');
    if (!yamlBlock) return;

    const rawText = yamlBlock.innerText;
    const variations = {};

    // Split by the separator "---" to get each theme block
    const blocks = rawText.split('---');

    blocks.forEach(block => {
        if (!block.trim()) return; // Skip empty blocks

        const currentThemeData = {};
        let themeName = null;

        // Split by lines
        const lines = block.trim().split('\n');

        lines.forEach(line => {
            // Find the first colon to separate Key and Value
            const separatorIndex = line.indexOf(':');
            if (separatorIndex === -1) return; // Skip invalid lines

            const key = line.substring(0, separatorIndex).trim();
            const value = line.substring(separatorIndex + 1).trim();

            if (key === 'Theme') {
                themeName = value;
            } else {
                currentThemeData[key] = value;
            }
        });

        if (themeName) {
            variations[themeName] = currentThemeData;
        }
    });

    // build the UI Controls
    const controlContainer = document.getElementById('variation-controls');
    controlContainer.innerHTML = '<span class="vibe-label">Choose your Vibe</span>';

    const btnGroup = document.createElement('div');
    btnGroup.className = 'vibe-buttons';

    // create a "Blueprint" (Reset) button
    const resetBtn = document.createElement('button');
    resetBtn.innerText = 'Blueprint';
    resetBtn.className = 'vibe-btn active';
    resetBtn.id = 'Blueprint';
    resetBtn.onclick = () => applyVariation('Blueprint', resetBtn);
    btnGroup.appendChild(resetBtn);

    // create buttons for each theme
    Object.keys(variations).forEach(theme => {
        const btn = document.createElement('button');
        btn.innerText = theme;
        btn.className = 'vibe-btn';
        btn.id = theme;
        btn.onclick = () => applyVariation(theme, btn);
        btnGroup.appendChild(btn);
    });

    controlContainer.appendChild(btnGroup);

    let blueprintsInitialized = false;

    function applyVariation(themeName, clickedBtn) {
        const url = new URL(window.location);
        url.searchParams.set('vibe', themeName);
        window.history.replaceState({}, '', url);

        // update Buttons Visual State
        document.querySelectorAll('.vibe-btn').forEach(b => b.classList.remove('active'));
        if (clickedBtn) clickedBtn.classList.add('active');

        // Find placeholders in the DOM
        if (!blueprintsInitialized) {
            const contentArea = document.querySelector('.recipe-container');
            if (contentArea) {
                const walker = document.createTreeWalker(contentArea, NodeFilter.SHOW_TEXT, null, false);
                let node;
                // split the string so Pelican/Jinja doesn't try to parse it
                const startBracket = '{' + '{';

                while(node = walker.nextNode()) {
                    if (node.nodeValue.includes(startBracket)) {
                        const parent = node.parentNode;
                        // Save original text if not already saved
                        if (!parent.hasAttribute('data-blueprint')) {
                            parent.setAttribute('data-blueprint', parent.innerHTML);
                            parent.classList.add('dynamic-slot');
                        }
                    }
                }
                blueprintsInitialized = true;
            }
        }

        // the update loop
        const slots = document.querySelectorAll('.dynamic-slot');

        slots.forEach(slot => {
            let htmlToUpdate = slot.getAttribute('data-blueprint');

            // Reset parent styling (Assume standard item first)
            if (slot.parentElement && slot.parentElement.tagName === 'LI') {
                slot.parentElement.classList.remove('is-sublist-parent');
            }

            // apply defined replacements
            if (themeName && variations[themeName]) {
                const replacements = variations[themeName];

                Object.keys(replacements).forEach(key => {
                    const regex = new RegExp('{' + '{' + key + '}' + '}', 'g');
                    let value = replacements[key];

                    // If this key exists in the current theme, replace it
                    if (value) {
                        if (key.includes('list')) {
                            // Multi-item List Logic
                            const items = value.split(';').map(item => `<li>${item.trim()}</li>`).join('');
                            value = `<ul class="dynamic-sublist">${items}</ul>`;
                        } else if (key.includes('step')) {
                            // step logic
                            value = `<ol class="dynamic-sublist"><li><strong>${value}</strong></li></ol>`;

                        } else {
                            // Standard Single Item
                            value = `<strong>${value}</strong>`;
                        }

                        htmlToUpdate = htmlToUpdate.replace(regex, value);
                    }
                });
            }

            // This handles "Blueprint Mode" AND any missing variables in specific themes
            const pillRegex = new RegExp('{' + '{([a-zA-Z0-9_]+?)}' + '}', 'g');

            htmlToUpdate = htmlToUpdate.replace(pillRegex, (match, key) => {
                const cleanName = key.replace(/_/g, ' ');

                if (key.includes('list') || key.includes('step')) {
                    return `<span class="variable-pill variable-list">${cleanName}</span>`;
                }
                return `<span class="variable-pill">${cleanName}</span>`;
            });

            // parens styling
            if (slot.closest('ul') || slot.closest('.recipe-ingredients')) {
                htmlToUpdate = htmlToUpdate.replace(/\(([^)<]+)\)(?![^<]*>)/g, '<span class="paren">($1)</span>');
                }

            // Render
            slot.innerHTML = htmlToUpdate;
            slot.classList.remove('changed');
            void slot.offsetWidth;
            slot.classList.add('changed');
        });
    }

    const urlParams = new URLSearchParams(window.location.search);
    const themeName = urlParams.get('vibe');

    if (Object.keys(variations).includes(themeName)) {
        applyVariation(themeName, document.getElementById(themeName));
    } else {
        applyVariation('Blueprint', document.querySelector('.vibe-btn.active'));
    }
});
</script>

                </div>
              </div><!-- #main -->
          </div><!-- #primary -->
        </div>
      </div><!-- close .row -->
    </div><!-- close .container -->
  </div><!-- close .site-content -->




  <div id="footer-area">
    <footer id="colophon" class="site-footer" role="contentinfo">
      <div class="site-info container">
        <div class="row">
                    <div class="copyright col-md-12">
                    This site uses the <a href="https://github.com/limbenjamin/voce">voce</a> theme by <a href="//limbenjamin.com/">Benjamin Lim</a><br />
                    &copy; 2025 <a href="../..">Josh Izaac</a> </div>
        </div>
      </div><!-- .site-info -->
      <div class="scroll-to-top" style="display: none;"><i class="fa fa-angle-up"></i></div><!-- .scroll-to-top -->
    </footer><!-- #colophon -->
  </div>


  <script type="text/javascript">
    window.addEventListener('load', function(){
      var e = document.querySelectorAll(".email");
      for (var i = 0; i < e.length; i++) {
        var email = e[i].getAttribute("data-email")
        var title = e[i].getAttribute("data-title")
        if (email){
          e[i].href = email.split("").reverse().join("");
          e[i].removeAttribute("data-email");
          e[i].removeAttribute("data-title");
          e[i].removeAttribute("class");
          if (title){
            e[i].setAttribute("title", title);
          }
          else{
            e[i].removeAttribute("title");
          }
        }
      }
    })
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
        const ninja = document.querySelector('ninja-keys');

        if (ninja) {
            // 1. Load your JSON index
            fetch('/search.json')
                .then(response => response.json())
                .then(data => {
                    // 2. Transform into Ninja Keys format
                    const menuItems = data.map(item => ({
                        id: item.url,
                        title: item.title,
                        section: item.type, // Groups results by 'Recipe' vs 'Page'
                        keywords: item.keywords,
                        handler: () => {
                            window.location.href = item.url;
                        }
                    }));

                    // 3. Add static actions (Optional)
                    // e.g., Dark Mode toggle, Home button
                    menuItems.push({
                        id: 'home',
                        title: 'Go to Home',
                        section: 'Navigation',
                        hotkey: 'cmd+h',
                        handler: () => { window.location.href = '/'; }
                    });

                    // 4. Give data to Ninja Keys
                    ninja.data = menuItems;
                })
                .catch(err => console.error("Failed to load search index:", err));
        }
    });
  </script>


  <ninja-keys placeholder="Search..." hideBreadcrumbs></ninja-keys>
</body>
</html>